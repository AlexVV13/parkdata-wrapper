<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>core/ParkBase.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module.exports.html">exports</a></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#FAMILY">FAMILY</a></li><li><a href="global.html#FASTPASS">FASTPASS</a></li><li><a href="global.html#INDOOR">INDOOR</a></li><li><a href="global.html#KIDS">KIDS</a></li><li><a href="global.html#OUTDOOR">OUTDOOR</a></li><li><a href="global.html#QUEUE_TYPES">QUEUE_TYPES</a></li><li><a href="global.html#SINGLE_RIDER">SINGLE_RIDER</a></li><li><a href="global.html#STANDBY">STANDBY</a></li><li><a href="global.html#TAGS">TAGS</a></li><li><a href="global.html#THRILL">THRILL</a></li><li><a href="global.html#VIRTUAL">VIRTUAL</a></li><li><a href="global.html#WATER">WATER</a></li><li><a href="global.html#_loadPOIDatabase">_loadPOIDatabase</a></li><li><a href="global.html#attraction">attraction</a></li><li><a href="global.html#buildDestinationEntity">buildDestinationEntity</a></li><li><a href="global.html#buildEntityLiveData">buildEntityLiveData</a></li><li><a href="global.html#buildParkEntities">buildParkEntities</a></li><li><a href="global.html#cache">cache</a></li><li><a href="global.html#cached">cached</a></li><li><a href="global.html#cachedFetch">cachedFetch</a></li><li><a href="global.html#destination">destination</a></li><li><a href="global.html#destinations">destinations</a></li><li><a href="global.html#downloadOfflinePackage">downloadOfflinePackage</a></li><li><a href="global.html#entityType">entityType</a></li><li><a href="global.html#fetchRaw">fetchRaw</a></li><li><a href="global.html#getAttractions">getAttractions</a></li><li><a href="global.html#getMetadata">getMetadata</a></li><li><a href="global.html#getOpeningTimes">getOpeningTimes</a></li><li><a href="global.html#getRestaurants">getRestaurants</a></li><li><a href="global.html#getShows">getShows</a></li><li><a href="global.html#getWaitTimeData">getWaitTimeData</a></li><li><a href="global.html#makeGraphQLQuery">makeGraphQLQuery</a></li><li><a href="global.html#mapQueues">mapQueues</a></li><li><a href="global.html#mapTags">mapTags</a></li><li><a href="global.html#normalizeEntity">normalizeEntity</a></li><li><a href="global.html#normalizeQueue">normalizeQueue</a></li><li><a href="global.html#normalizeSchedule">normalizeSchedule</a></li><li><a href="global.html#park">park</a></li><li><a href="global.html#restaurant">restaurant</a></li><li><a href="global.html#show">show</a></li><li><a href="global.html#stringHoursToNumbers">stringHoursToNumbers</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">core/ParkBase.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { cached } from "./cache.js";
import { QUEUE_TYPES } from "./queueTypes.js";
import { TAGS } from "./tagsConfig.js";

/**
 * Callback type voor een async fetch functie.
 * @callback FetchFn
 * @returns {Promise&lt;any>}
 */

/**
 * Abstracte base class voor een attractiepark.
 * Wordt uitgebreid door concrete parkmodules.
 */
export default class ParkBase {
  /**
   * @param {Object} options
   * @param {string} options.parkId - Unieke ID van het park
   * @param {string} options.name - Naam van het park
   * @param {string|null} options.destination - Resortnaam of null
   * @param {Object} options.apiConfig - API configuratie { baseUrl, options }
   * @param {string} [options.timezone=Europe/Paris] - Tijdzone van het park
   */
  constructor({ parkId, name, destination, apiConfig, timezone = "Europe/Paris" }) {
    this.parkId = parkId;
    this.name = name;
    this.destination = destination;
    this.apiConfig = apiConfig;
    this.timezone = timezone;
  }

  // -------------------
  // API Fetch helpers
  // -------------------

  /**
   * Voer een raw fetch uit naar de API.
   * @param {string} endpoint - Endpoint achter baseUrl
   * @returns {Promise&lt;any>} JSON response
   */
  async fetchRaw(endpoint) {
    const url = `${this.apiConfig.baseUrl}/${endpoint}`;
    const opts = this.apiConfig.options || {};
    const resp = await fetch(url, opts);
    if (!resp.ok) {
      throw new Error(`Failed to fetch ${url}: ${resp.status}`);
    }
    return resp.json();
  }

  /**
   * Cached fetch wrapper.
   * @param {string} key - Cache key
   * @param {number} ttl - Tijd in seconden
   * @param {FetchFn} fn - Async fetch functie
   * @returns {Promise&lt;any>}
   */
  async cachedFetch(key, ttl, fn) {
    return cached(`${this.parkId}:${key}`, ttl, fn);
  }

  // -------------------
  // Abstract data getters
  // -------------------

  /**
   * Haal attracties op van het park.
   * @abstract
   * @returns {Promise&lt;Array&lt;Object>>}
   */
  async getAttractions() {
    throw new Error("Must implement getAttractions()");
  }

  /**
   * Haal shows op van het park.
   * @abstract
   * @returns {Promise&lt;Array&lt;Object>>}
   */
  async getShows() {
    throw new Error("Must implement getShows()");
  }

  /**
   * Haal restaurants op van het park.
   * @abstract
   * @returns {Promise&lt;Array&lt;Object>>}
   */
  async getRestaurants() {
    throw new Error("Must implement getRestaurants()");
  }

  /**
   * Haal openingstijden op van het park.
   * @abstract
   * @returns {Promise&lt;Array&lt;Object>>}
   */
  async getOpeningTimes() {
    throw new Error("Must implement getOpeningTimes()");
  }

  // -------------------
  // Helpers &amp; utilities
  // -------------------

  /**
   * Normaliseer wachtrij data.
   * @param {Object} options
   * @param {number|null} [options.waitTime=null] - Wachttijd in minuten
   * @param {string} [options.status="Closed"] - Status van de wachtrij
   * @param {string} [options.type=QUEUE_TYPES.STANDBY] - Type wachtrij
   * @returns {Object} Genormaliseerd wachtrij object
   */
  normalizeQueue({ waitTime = null, status = "Closed", type = QUEUE_TYPES.STANDBY }) {
    return {
      queue_type: type,
      display_wait_time: waitTime,
      status,
    };
  }

  /**
   * Normaliseer entity data (attractie, show, restaurant).
   * @param {Object} options
   * @param {string} options.id - Unieke ID binnen het park
   * @param {string} options.name - Naam van de entity
   * @param {string} options.entityType - Type entity ("ride", "show", "restaurant")
   * @param {Array&lt;string>} [options.tags=[]] - Tags
   * @param {Object} [options.location={}] - Locatie { lat, lng }
   * @param {number|null} [options.waitTime=null] - Wachttijd
   * @param {string} [options.status="Closed"] - Status
   * @param {Array&lt;Object>} [options.queues=[]] - Queue data
   * @returns {Object} Genormaliseerd entity object
   */
  normalizeEntity({ id, name, entityType, tags = [], location = {}, waitTime = null, status = "Closed", queues = [] }) {
    return {
      id: `${this.parkId}-${id}`,
      name,
      entityType,
      destination: this.destination,
      park: this.name,
      tags,
      location,
      status,
      waitTime,
      queues,
      lastUpdated: new Date().toISOString(),
    };
  }

  /**
   * Bouw een standaard openingstijd object.
   * @param {Object} options
   * @param {string} options.date - Datum in 'YYYY-MM-DD'
   * @param {string|null} [options.openingTime=null] - Openingstijd ISO
   * @param {string|null} [options.closingTime=null] - Sluitingstijd ISO
   * @param {string} [options.type="OPERATING"] - Type dag
   * @returns {Object} Genormaliseerd openingstijd object
   */
  normalizeSchedule({ date, openingTime = null, closingTime = null, type = "OPERATING" }) {
    return {
      date,
      openingTime,
      closingTime,
      type,
    };
  }

  /**
   * Haal metadata op over dit park.
   * @returns {Object} Metadata object
   */
  getMetadata() {
    return {
      id: this.parkId,
      name: this.name,
      destination: this.destination,
      timezone: this.timezone,
      tags: TAGS[this.parkId] || [],
    };
  }
}

</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Sun Sep 28 2025 14:16:48 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
